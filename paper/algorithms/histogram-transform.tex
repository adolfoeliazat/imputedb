%\begin{algorithm}
  \begin{algorithmic}
    \Require{$\mathbb{H}$ is a map from attribute names to histograms, $op$ is an operator node in a logical query plan}
    \Ensure{Returns an updated map $\mathbb{H'}$}
    
    \Function{UpdateHistograms}{$\mathbb{H}, op$}
    	\If{$op \not\in \{\delta, \mu, \sigma, \bowtie \}$}
		\Return{$\mathbb{H}$}
	\EndIf
	\State $\mathbb{H'} \gets \Call{Copy}{\mathbb{H}}$
    	\If{op = $\delta_C$}
		\For{$c \in C$}
			\State $\mathbb{H'}[c][null] \gets 0$
		\EndFor
		\State $minCardinality \gets \Call{Min}{ \{ \Call{Total}{\mathbb{H'}[c]}  | c \in C \} }$
		\For{$c \in dom(\mathbb{H'})$}
			\State $\Call{ScaleTo}{ \mathbb{H'}[c], minCardinality }$
		\EndFor
	\ElsIf{op = $\mu_C$}
		\For{$c \in C$}
			\State \Call{Add}{$\mathbb{H'}[c], \mathbb{H'}[c][null]$}
		\EndFor
	\ElsIf{op = $\sigma$}
		\For{$c \in dom(\mathbb{H'})$}
			\State \Call{ScaleBy}{$\mathbb{H'}[c],  \Call{Selectivity}{\sigma}$} 
		\EndFor
	\ElsIf{op = $\bowtie_\phi$}
		\For{$c \in dom(\mathbb{H'})$}
			\State \Call{ScaleTo}{$\mathbb{H'}[c], \Call{Cardinality}{\bowtie_{\phi}}$}
		\EndFor
	\EndIf
	\Return{$\mathbb{H'}$}
    \EndFunction
  \end{algorithmic}
  \caption{An algorithm for in-plan histogram updates}
  \label{algo:histogram-transformation}
%\end{algorithm}
